
# ===========================================
# PRODUCTION-SAFE SPRING BOOT CONFIGURATION
# ===========================================

spring.application.name=${APP_NAME:financial-ledger-backend}

# Server Configuration
server.port=${PORT:8080}

# ===========================================
# MYSQL DATABASE CONFIGURATION (RAILWAY)
# ===========================================
spring.datasource.url=${DATABASE_URL:jdbc:mysql://mysql.railway.internal:3306/railway?useSSL=true&requireSSL=true&serverTimezone=UTC&allowPublicKeyRetrieval=true}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:oRJZwEopJZhRPGAURAPBtKcMjovtpuzz}

# Connection Pool Settings (Production-Ready)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.connection-timeout=30000

# ===========================================
# JPA/HIBERNATE CONFIGURATION
# ===========================================
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
# CRITICAL: NEVER recreate tables in production
spring.jpa.hibernate.ddl-auto=none
# Production: Disable SQL logging for performance
spring.jpa.show-sql=false
# Enable SQL formatting for debugging (can be disabled later)
spring.jpa.properties.hibernate.format_sql=true
# Additional Hibernate optimizations
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ===========================================
# DATABASE INITIALIZATION (PRODUCTION-SAFE)
# ===========================================
# CRITICAL: NEVER run SQL init scripts in production
spring.sql.init.mode=never
# Ensure MySQL timezone handling
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# ===========================================
# SECURITY & CORS
# ===========================================
# CORS Configuration (Update with your Vercel domain)
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://your-vercel-app.vercel.app,http://localhost:3000}

# ===========================================
# JWT CONFIGURATION
# ===========================================
jwt.secret=${JWT_SECRET:CHANGE_THIS_IN_PRODUCTION_TO_A_SECURE_256_BIT_KEY}
jwt.expiration=${JWT_EXPIRATION:86400000}

# ===========================================
# FILE UPLOAD CONFIGURATION
# ===========================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.file-size-threshold=2KB
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ===========================================
# LOGGING CONFIGURATION
# ===========================================
logging.level.com.financial.ledger=INFO
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ===========================================
# HEALTH CHECKS
# ===========================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# Disable H2 (ensure no fallback to in-memory database)
spring.h2.console.enabled=false

# ===========================================
# IMPORTANT PRODUCTION NOTES
# ===========================================
# 1. Update CORS_ALLOWED_ORIGINS with your actual Vercel domain
# 2. Generate a secure 256-bit JWT secret for production
# 3. Ensure Railway database has persistent storage configured
# 4. Never set ddl-auto=update or sql.init.mode=always in production
